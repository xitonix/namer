<?xml version="1.0" encoding="utf-8"?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Name="$(var.Binary) $(var.AppVersion)"
    Manufacturer="https://xitonix.io"
    Id="8ebcb318-b30f-4b6c-9223-cb90a5e067e8"
    UpgradeCode="092cdb38-5c04-4d65-9b64-f9270de40816"
    Language="1033"
    Codepage="1252"
    Version="$(var.WixVersion)">
    <Package Id="*"
      Keywords="Installer"
      Description="$(var.Binary) v$(var.AppVersion) Installer"
      Languages="1033"
      InstallerVersion="200"
      InstallScope="perMachine"
      Compressed="yes"
      SummaryCodepage="1252" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />

    <Media Id="1" Cabinet="$(var.Binary).cab" EmbedCab="yes" CompressionLevel="high" />
    <Condition Message="Windows 7 (with Service Pack 1) or greater required.">
      ((VersionNT > 601) OR (VersionNT = 601 AND ServicePackLevel >= 1))
    </Condition>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLDIR" Name="$(var.Binary)">
          <Component Id="MainExecutable" Guid="daa6428b-5bc0-4fa7-900c-a27cb40b420b">
            <File Id="AppExe" Name="$(var.Binary).exe" DiskId="1" Source="$(var.Binary).exe" KeyPath="yes" />
          </Component>
        </Directory>
      </Directory>
      <Directory Id="EnvironmentEntries">
        <Directory Id="AppEnvironmentEntries">
          <Component Id="AppEnvironment" Guid="8f2aa3ac-1de5-4920-9f2d-4426c6634a37">
            <Environment
              Id="PathEntry"
              Action="set"
              Part="last"
              Name="PATH"
              Permanent="no"
              System="yes"
              Value="[INSTALLDIR]" />
            <RemoveFolder
              Id="AppEnvironmentEntries"
              On="uninstall" />
          </Component>
        </Directory>
      </Directory>
    </Directory>

    <Feature Id="Complete" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="AppEnvironment" />
    </Feature>

    <CustomActionRef Id="WixBroadcastEnvironmentChange" />

    <UIRef Id="WixUI_InstallDir" />
    <UIRef Id="WixUI_ErrorProgressText" />
  </Product>
</Wix>